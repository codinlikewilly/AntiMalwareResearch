from tkinter import filedialog
from tkinter import *
from tkinter import scrolledtext
from tkinter import messagebox

from Bio import SeqIO
from Bio.SubsMat.MatrixInfo import blosum62
from Bio import Align
from Bio import pairwise2
from generatesequence import *
from Bio.pairwise2 import format_alignment

alingner = Align.PairwiseAligner()
 
window = Tk()
 
window.title("File DNA")
file1 = ""
file2 = ""
 

 
lbl = Label(window, text="No file selected", state = 'disabled')
b2 = Label(window, text="No file selected", state = 'disabled') 
lbl.grid(column=1, row=0)
b2.grid(column=1, row=1)


 
 
def clicked():
    global file1
    window.filename =  filedialog.askopenfilename(initialdir = "C:/Users/wills/OneDrive/Desktop/Research",title = "Select file",filetypes = (("all files", "*.*"),("jpeg files","*.jpg")))
    res = "File 1: " + window.filename
    file1 = window.filename
    b1 = tobinary(file1)
    f1seq = (generateseq(b1))
    seq1.insert(INSERT,"Seq 1: " + f1seq)
    lbl.configure(text= res)
    print(window.filename)


def clicked2():
    global file2
    window.filename =  filedialog.askopenfilename(initialdir = "C:/Users/wills/OneDrive/Desktop/Research",title = "Select file",filetypes = (("all files", "*.*"),("jpeg files","*.jpg")))
    res = "File 2: " + window.filename
    file2 = window.filename
    b1 = tobinary(file2)
    f2seq = (generateseq(b1))
    seq2.insert(INSERT,"Seq 2: " + f2seq)
    b2.configure(text= res)
    





def main():
    b1 = tobinary(file1)
    f1seq = (generateseq(b1))

    b1 = tobinary(file2)
    f2seq = (generateseq(b1))

    X = f1seq
    Y = f2seq
    alignments = pairwise2.align.globalms(X, Y, 2, -1, -0.5, -0.1)

    chars_i_want = set('ACTG,-')
    final_string = ''.join(c for c in str(alignments) if c in chars_i_want)
    string = final_string.split(",")
    s1 = string[0]
    s2 = string[1]
    
    print("longest substring: " + longest_substring(s1,s2))
    final = (generatehex(longest_substring(s1,s2)))
    
      #messagebox.showinfo("Signature", final)
    result.insert(INSERT,"Signature: " + final)












seq2 = scrolledtext.ScrolledText(window,width = 50, height = 10)
seq2.grid(column = 1, row = 14)

s1label = Label(window, text="Sequence of File 1", state = 'disabled')

seq1 = scrolledtext.ScrolledText(window,width = 50, height = 10)
seq1.grid(column = 1, row = 12)

result = scrolledtext.ScrolledText(window,width = 50, height = 10)
result.grid(column = 2, row = 12)


btn = Button(window, text="Choose file 1", command=clicked)
btn2 = Button(window, text="Choose file 2", command=clicked2)
btn3 = Button(window, text = "Generate Signature", command = main)
btn3.grid (column = 1, row = 6)
btn2.grid(column=0,row=1)
 
btn.grid(column=0, row=0)


window.mainloop()
